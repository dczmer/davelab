<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Useful Commands</title>
    <link rel="stylesheet" href="http://localhost:4000//jekyll-test/css/reset.css" />
    <link rel="stylesheet" href="http://localhost:4000//jekyll-test/css/dracula-rouge.css" />
    <link rel="stylesheet" href="http://localhost:4000//jekyll-test/css/site.css" />
    <link rel="shortuct icon" type="image/ico" href="http://localhost:4000//jekyll-test/img/favicon.ico" />
  </head>
  <body>
    <header>
      <section>
        <a href="/jekyll-test/"> davelab</a>
      </section>
      <section title="I feel like there needs to be something on this side...">
        <a href="https://github.com/dczmer/davelab.git">
           GitHub
        </a>
      </section>
    </header>
    <nav>
      <section>
        
        
          
          
          
        
          
          
          
            <section class="subnav">
              <span class="">
                Zsh configuration
              </span>
              <ul class="subnav-inactive">
                
                
                  <li>
                    <a
                      class=""
                      href="http://localhost:4000/jekyll-test/zsh_configuration/index"
                    >
                      ZSH Configuration Intro
                    </a>
                  </li>
                
                  <li>
                    <a
                      class=""
                      href="http://localhost:4000/jekyll-test/zsh_configuration/01_zsh-config"
                    >
                      Basic ZSH Configuration
                    </a>
                  </li>
                
                  <li>
                    <a
                      class=""
                      href="http://localhost:4000/jekyll-test/zsh_configuration/02_prompt"
                    >
                      Configuring Your Prompt
                    </a>
                  </li>
                
                  <li>
                    <a
                      class=""
                      href="http://localhost:4000/jekyll-test/zsh_configuration/03_completion"
                    >
                      The Completion System
                    </a>
                  </li>
                
                  <li>
                    <a
                      class=""
                      href="http://localhost:4000/jekyll-test/zsh_configuration/04_complete-setup"
                    >
                      Completed Configuration
                    </a>
                  </li>
                
              </ul>
            </section>
          
        
          
          
          
            <section class="subnav">
              <span class="selected-module">
                Using the shell
              </span>
              <ul class="">
                
                
                  <li>
                    <a
                      class=""
                      href="http://localhost:4000/jekyll-test/using_the_shell/index"
                    >
                      Shell Intro
                    </a>
                  </li>
                
                  <li>
                    <a
                      class=""
                      href="http://localhost:4000/jekyll-test/using_the_shell/01_help-hisory"
                    >
                      Finding Help
                    </a>
                  </li>
                
                  <li>
                    <a
                      class=""
                      href="http://localhost:4000/jekyll-test/using_the_shell/02_expansion-signals"
                    >
                      Expansion and Signals
                    </a>
                  </li>
                
                  <li>
                    <a
                      class=""
                      href="http://localhost:4000/jekyll-test/using_the_shell/03_streams-and-pipes"
                    >
                      (WIP) Streams and Pipes
                    </a>
                  </li>
                
                  <li>
                    <a
                      class="selected-section"
                      href="http://localhost:4000/jekyll-test/using_the_shell/04_commands"
                    >
                      Useful Commands
                    </a>
                  </li>
                
                  <li>
                    <a
                      class=""
                      href="http://localhost:4000/jekyll-test/using_the_shell/05_one-liners"
                    >
                      (WIP) Useful One-Liners
                    </a>
                  </li>
                
              </ul>
            </section>
          
        
          
          
          
            <section class="subnav">
              <span class="">
                Tmux
              </span>
              <ul class="subnav-inactive">
                
                
                  <li>
                    <a
                      class=""
                      href="http://localhost:4000/jekyll-test/tmux/index"
                    >
                      Tmux Intro
                    </a>
                  </li>
                
                  <li>
                    <a
                      class=""
                      href="http://localhost:4000/jekyll-test/tmux/01_basic-usage"
                    >
                      Tmux Basic Usage
                    </a>
                  </li>
                
                  <li>
                    <a
                      class=""
                      href="http://localhost:4000/jekyll-test/tmux/02_configuration"
                    >
                      Tmux Configuration
                    </a>
                  </li>
                
              </ul>
            </section>
          
        
      </section>
    </nav>
    <main>
      <ul id="markdown-toc">
  <li><a href="#useful-commands" id="markdown-toc-useful-commands">Useful Commands</a>    <ul>
      <li><a href="#overview" id="markdown-toc-overview">Overview</a></li>
      <li><a href="#echo---i-want-to-print-a-string" id="markdown-toc-echo---i-want-to-print-a-string">echo - I Want to Print a String</a></li>
      <li><a href="#cat---i-want-to-print-a-file" id="markdown-toc-cat---i-want-to-print-a-file">cat - I Want to Print a File</a></li>
      <li><a href="#printf---i-want-to-print-a-formatted-string" id="markdown-toc-printf---i-want-to-print-a-formatted-string">printf - I Want to Print a Formatted String</a></li>
      <li><a href="#wc---i-want-to-count-linesentrieswordsbytes" id="markdown-toc-wc---i-want-to-count-linesentrieswordsbytes">wc - I Want to Count Lines/Entries/Words/Bytes</a></li>
      <li><a href="#less---i-want-to-print-one-page-of-output-at-a-time" id="markdown-toc-less---i-want-to-print-one-page-of-output-at-a-time">less - I Want to Print One “Page” of Output at a Time</a></li>
      <li><a href="#headtail---i-want-to-see-just-the-firstlast-few-lines" id="markdown-toc-headtail---i-want-to-see-just-the-firstlast-few-lines">head/tail - I Want to See Just The First/Last Few Lines</a></li>
      <li><a href="#grep---i-want-to-search-for-text-or-filter-lines" id="markdown-toc-grep---i-want-to-search-for-text-or-filter-lines">grep - I Want to Search for Text Or Filter Lines</a></li>
      <li><a href="#find---i-want-to-find-files-or-folders" id="markdown-toc-find---i-want-to-find-files-or-folders">find - I Want to Find Files or Folders</a></li>
      <li><a href="#column---i-want-to-format-a-list-of-records-into-a-table" id="markdown-toc-column---i-want-to-format-a-list-of-records-into-a-table">column - I Want to Format a List of Records Into a Table</a></li>
      <li><a href="#sort---i-want-to-sort-lines" id="markdown-toc-sort---i-want-to-sort-lines">sort - I Want to Sort Lines</a></li>
      <li><a href="#uniq---i-want-to-de-duplicate-lines" id="markdown-toc-uniq---i-want-to-de-duplicate-lines">uniq - I Want to De-duplicate Lines</a></li>
      <li><a href="#cut---i-want-to-print-selected-parts-of-a-string" id="markdown-toc-cut---i-want-to-print-selected-parts-of-a-string">cut - I Want to Print Selected Parts of a String</a></li>
      <li><a href="#sed---i-want-to-run-a-regex-or-substitution-over-lines" id="markdown-toc-sed---i-want-to-run-a-regex-or-substitution-over-lines">sed - I Want to Run a regex or Substitution Over Lines</a></li>
      <li><a href="#xargs---i-want-to-run-a-command-for-every-line" id="markdown-toc-xargs---i-want-to-run-a-command-for-every-line">xargs - I Want to Run a Command for Every Line</a>        <ul>
          <li><a href="#xargs---i-want-to-quickly-trim-white-space-padding-from-a-string" id="markdown-toc-xargs---i-want-to-quickly-trim-white-space-padding-from-a-string">xargs - I Want to Quickly Trim White-Space Padding From a String</a></li>
        </ul>
      </li>
      <li><a href="#curl---i-want-to-make-an-http-request" id="markdown-toc-curl---i-want-to-make-an-http-request">curl - I Want to Make an HTTP Request</a></li>
      <li><a href="#awk---i-want-to-filter-format-or-translate-tables" id="markdown-toc-awk---i-want-to-filter-format-or-translate-tables">awk - I Want to Filter, Format, or Translate Tables</a></li>
      <li><a href="#jq---i-want-to-filter-format-or-translate-json" id="markdown-toc-jq---i-want-to-filter-format-or-translate-json">jq - I Want to Filter, Format, or Translate JSON</a>        <ul>
          <li><a href="#basics" id="markdown-toc-basics">Basics</a></li>
          <li><a href="#you-can-turn-a-table-of-data-into-an-array-of-json-data" id="markdown-toc-you-can-turn-a-table-of-data-into-an-array-of-json-data">You can turn a table of data into an array of JSON data</a></li>
          <li><a href="#turn-a-table-of-data-into-a-list-of-json-objects" id="markdown-toc-turn-a-table-of-data-into-a-list-of-json-objects">Turn a table of data into a list of JSON objects:</a></li>
          <li><a href="#you-can-turn-a-json-array-into-a-table-of-data" id="markdown-toc-you-can-turn-a-json-array-into-a-table-of-data">You can turn a JSON array into a table of data:</a></li>
          <li><a href="#turn-list-of-json-objects-into-lines-of-records" id="markdown-toc-turn-list-of-json-objects-into-lines-of-records">Turn list of JSON objects into lines of records:</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h1 id="useful-commands">Useful Commands</h1>

<h2 id="overview">Overview</h2>

<p>This <code>linux</code> philosophy is that each tool should do one thing, and do that one thing well. Think of these commands as primitive building blocks that we can combine to write little programs that work on “lines of text” as data.</p>

<p>You don’t have to master every command, you just need to what job they perform, so you know which command(s) to reach for when you have a problem.</p>

<p>A simplified overview of the process is that it’s mostly about printing, filtering, and formatting lines of text and feeding the result into the next program, or just printing it out to the screen.</p>

<ol>
  <li>Put something onto an output stream.</li>
  <li>Filter, translate, and format lines.</li>
  <li>Redirect the output to the <code>stdin</code> stream of another command to do the next step.</li>
  <li>Repeat steps 2 &amp; 3 until you have done something useful.</li>
</ol>

<p>Read along and try out each of the examples as you go. Try reading the <code>man</code> pages for each command and experimenting with the examples. In the next section, we’ll use these to make some useful “one-liners”.</p>

<h2 id="echo---i-want-to-print-a-string">echo - I Want to Print a String</h2>

<p>Print some text to the <code>stdout</code> stream:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"Hello world!"</span>
</code></pre></div></div>

<p>Example:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"Hello world!"</span> | <span class="nb">wc</span> <span class="nt">-c</span>
</code></pre></div></div>

<p>This will redirect the output to <code>wc</code> to count the number of characters in the string.</p>

<h2 id="cat---i-want-to-print-a-file">cat - I Want to Print a File</h2>

<p>Print the contents of a file to <code>stdout</code>.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> ./README.md
</code></pre></div></div>

<p>Example:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> ./README.md | <span class="nb">head</span>
</code></pre></div></div>

<p>Prints the contents of the <code>README.md</code> file, then redirects to <code>head</code> to print only the last few lines of text.</p>

<h2 id="printf---i-want-to-print-a-formatted-string">printf - I Want to Print a Formatted String</h2>

<p>This is like <code>printf/sprintf</code> from <code>C</code>. You can use this to interpolate and format a value into a format-string template. However, the behavior of this function varies from shell to shell. We’ll be using the <code>zsh</code> version.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">printf</span> <span class="s1">'Hello %s, you have $%05.2f in your account.\n'</span> Frank 1.23456
</code></pre></div></div>

<p>This would print <code>Hello Frank, you have $01.23 in your account.</code></p>

<ul>
  <li>The <code>%s</code> is a place-holder for a string argument.</li>
  <li><code>%f</code> is a place-holder for a floating-point number.</li>
  <li><code>%05.2f</code> controls the formatting of the floating-point number:
    <ul>
      <li><code>05</code> following the <code>%</code>, means the value should have a minimum width of 5 characters and should use a <code>0</code> to pad the front of the string.</li>
      <li><code>.2</code> controls formatting the decimal to show only two digits.</li>
    </ul>
  </li>
</ul>

<h2 id="wc---i-want-to-count-linesentrieswordsbytes">wc - I Want to Count Lines/Entries/Words/Bytes</h2>

<p>You can use <code>wc</code> to count the number of lines, characters, bytes, or calculate the maximum line width of a file or stream of text. It can take input from <code>stdin</code> or from a filename as a positional argument.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">wc</span> <span class="nt">-L</span> README.md
</code></pre></div></div>

<p>This would print the length of the longest line in the <code>README.md</code> file.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"1</span><span class="se">\n</span><span class="s2">2</span><span class="se">\n\3\n</span><span class="s2">"</span> | <span class="nb">wc</span> <span class="nt">-l</span>
</code></pre></div></div>

<p>This would print the number of lines of text from the input string (3).</p>

<h2 id="less---i-want-to-print-one-page-of-output-at-a-time">less - I Want to Print One “Page” of Output at a Time</h2>

<p>When you want to read and search through the output stream, you can pipe it to <code>less</code>. It will show one page/screen of data at a time, and prompt for you to press a key to show the next page. You can also search though the text using <code>/</code>.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>README.md | less
</code></pre></div></div>

<h2 id="headtail---i-want-to-see-just-the-firstlast-few-lines">head/tail - I Want to See Just The First/Last Few Lines</h2>

<p>Sometimes you only care about the very end or the very beginning of the stream.</p>

<p><code>head</code> will print the first few lines of a stream or file.</p>

<p><code>tail</code> will print the last few lines of a stream or file.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> <span class="nt">-t</span> <span class="nb">.</span> | <span class="nb">head</span> <span class="nt">-n1</span>
</code></pre></div></div>

<p>This would show the most recently modified file or folder in the current directory. <code>ls -t</code> sorts by the most recent modification time, and <code>head -n1</code> shows the first line of that output.</p>

<p>You can also use <code>tail</code> to watch a file and print it’s contents to the screen, as it’s being written to.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">tail</span> <span class="nt">-f</span> /path/to/logfile.log
</code></pre></div></div>

<h2 id="grep---i-want-to-search-for-text-or-filter-lines">grep - I Want to Search for Text Or Filter Lines</h2>

<p>Search for patterns in files or streams. You can use this to find files that contain text that matches a regular expression or to filter lines of output from a stream.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">grep</span> <span class="nt">-Ei</span> <span class="s1">'TODO|NOTE'</span> <span class="nb">.</span> <span class="nt">-R</span>
</code></pre></div></div>

<p>Case-insensitive search through all files under the current directory for <code>TODO</code> or <code>NOTE</code>.</p>

<ul>
  <li><code>-E</code> means use extended regex support. You might even want to <code>alias -- grep='grep -E'</code>.</li>
  <li><code>-i</code> makes the search case-insensitive.</li>
  <li><code>-R</code> means recursively search everything under the target.</li>
</ul>

<p>You can also use grep to filter output from a stream:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>README.md | <span class="nb">grep</span> <span class="nt">-E</span> <span class="s1">'^## '</span>
</code></pre></div></div>

<p>This would print all of the level two headings from the markdown file.</p>

<p>You can also invert the search with <code>-v</code>, to print only the lines that do not match the pattern.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>README.md | <span class="nb">grep</span> <span class="nt">-v</span> pattern
</code></pre></div></div>

<p>This would print the markdown file but filter out every line that has the string “pattern” in it.</p>

<h2 id="find---i-want-to-find-files-or-folders">find - I Want to Find Files or Folders</h2>

<p>Search for files under a directory.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find <span class="nb">.</span> <span class="nt">-name</span> <span class="s1">'*.md`
</span></code></pre></div></div>

<p>This would find all of the <code>markdown</code> files under the current directory.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find ~ <span class="nt">-type</span> d <span class="nt">-maxdepth</span> 1 <span class="nt">-name</span> <span class="s1">'.*'</span>
</code></pre></div></div>

<p>This would find all of the directories (<code>-type d</code>), under your home directory (<code>~</code>), up to a maximum depth of 1 (<code>-maxdepth 1</code>), who’s names start with a ‘.’ (hidden files).</p>

<p class="note">The pattern is a <code>glob</code>, not a regular expression.</p>

<p class="note">You should use single quotes around the pattern. Otherwise, the <code>*</code> would expand and be replaced with the names of all files in the current directory before the command runs.</p>

<h2 id="column---i-want-to-format-a-list-of-records-into-a-table">column - I Want to Format a List of Records Into a Table</h2>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"1 2222 33</span><span class="se">\n</span><span class="s2">4444 5 66</span><span class="se">\n</span><span class="s2">7 8888 9"</span> | column <span class="nt">--table</span> <span class="nt">--table-columns</span><span class="o">=</span>A,B,C
</code></pre></div></div>

<p>Would produce the following table:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>A     B     C
1     2222  33
4444  5     66
7     8888  9
</code></pre></div></div>

<p>If you wanted to make this a CSV table, add <code>-o,</code> to use a comma as the separator.</p>

<h2 id="sort---i-want-to-sort-lines">sort - I Want to Sort Lines</h2>

<p>Sort lines of text.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"3</span><span class="se">\n\1\n</span><span class="s2">4</span><span class="se">\n</span><span class="s2">2</span><span class="se">\n</span><span class="s2">"</span> | <span class="nb">sort</span> <span class="nt">-r</span>
</code></pre></div></div>

<p>Would sort the lines in reverse order (<code>-r</code>).</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"1 2222 33</span><span class="se">\n</span><span class="s2">4444 5 66</span><span class="se">\n</span><span class="s2">7 8888 9"</span> | <span class="nb">sort</span> <span class="nt">-k</span> 2
</code></pre></div></div>

<p>Would sort the table by the values in the second column. By default, it will do a “C” / ASCII sort order. If not, ensure that you have set <code>LC_ALL=C</code> in your <code>~/.zshrc</code> file.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2222 33
4444 5 66
7 8888 9
</code></pre></div></div>

<p>If you wanted to sort by the second column numerically, use <code>-n</code>:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"1 2222 33</span><span class="se">\n</span><span class="s2">4444 5 66</span><span class="se">\n</span><span class="s2">7 8888 9"</span> | <span class="nb">sort</span> <span class="nt">-nk</span> 2
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4444 5 66
1 2222 33
7 8888 9
</code></pre></div></div>

<h2 id="uniq---i-want-to-de-duplicate-lines">uniq - I Want to De-duplicate Lines</h2>

<p>Filter duplicate lines out of the stream.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"1</span><span class="se">\n</span><span class="s2">2</span><span class="se">\n</span><span class="s2">1</span><span class="se">\n</span><span class="s2">3</span><span class="se">\n</span><span class="s2">1</span><span class="se">\n</span><span class="s2">4</span><span class="se">\n</span><span class="s2">"</span> | <span class="nb">sort</span> | <span class="nb">uniq</span>
</code></pre></div></div>

<p class="note"><code>uniq</code> only filters duplicate lines if they are adjacent to each other. So you typically run the output through <code>sort</code> first.</p>

<h2 id="cut---i-want-to-print-selected-parts-of-a-string">cut - I Want to Print Selected Parts of a String</h2>

<p>You can use <code>cut</code> to print selected bytes, characters, or ‘fields’ from a line.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"1 2 3 4"</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">' '</span> <span class="nt">-f3</span>
</code></pre></div></div>

<p>This would print the third ‘field’ of the input records, where ‘ ‘ (space) is the field separator (delimiter). This would print <code>3</code>.</p>

<h2 id="sed---i-want-to-run-a-regex-or-substitution-over-lines">sed - I Want to Run a regex or Substitution Over Lines</h2>

<p>“A stream editor for filtering and transforming text.”</p>

<p><code>sed</code> is very powerful, but the main thing I use it for is running a regex substitution over every line in a stream.</p>

<p>This would replace all of the ‘-‘ characters with spaces:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"1-2-3-4"</span> | <span class="nb">sed</span> <span class="s1">'s/-/ /g'</span>
</code></pre></div></div>

<p>This would change each line from <code>Hello X</code>, to <code>Bye X</code>:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"Hello A</span><span class="se">\n</span><span class="s2">Hello B</span><span class="se">\n</span><span class="s2">"</span> | <span class="nb">sed</span> <span class="s1">'s/Hello \(.*\)/Bye \1/'</span>
</code></pre></div></div>

<h2 id="xargs---i-want-to-run-a-command-for-every-line">xargs - I Want to Run a Command for Every Line</h2>

<p>Execute a command against each line in a stream.</p>

<p>This would find all files under the current directory and run the <code>file</code> command on each one:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find <span class="nb">.</span> <span class="nt">-type</span> f | xargs file
</code></pre></div></div>

<p>This will find all the markdown files under the current directory and then search each one for level-one headings:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find <span class="nb">.</span> <span class="nt">-name</span> <span class="s1">'*.md'</span> | xargs <span class="nb">grep</span> <span class="nt">-n</span> <span class="s1">'^# '</span>
</code></pre></div></div>

<p>Sometimes you need to use the value to <code>xargs</code> as a positional argument, so you need a variable to use in your command. The <code>-I</code> switch defines the variable pattern, which will be replaced with the actual argument when it runs. A common convention is to use <code>{}</code> because you are unlikely to use that exact string in your final command.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find <span class="nb">.</span> <span class="nt">-name</span> <span class="s1">'*.md'</span> | xargs <span class="nt">-I</span><span class="o">{}</span> <span class="nb">printf</span> <span class="s2">"'%s'</span><span class="se">\n</span><span class="s2">"</span> <span class="o">{}</span>
</code></pre></div></div>

<p>This would find all the markdown files and print their names in single quotes.</p>

<h3 id="xargs---i-want-to-quickly-trim-white-space-padding-from-a-string">xargs - I Want to Quickly Trim White-Space Padding From a String</h3>

<p>Another use for <code>xargs</code> is to quickly trip leading/trailing white-space from a string. If you pipe something to <code>xargs</code> with no arguments, then it will simply strip the white-space and echo the value:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'      hi     '</span> | xargs
</code></pre></div></div>

<h2 id="curl---i-want-to-make-an-http-request">curl - I Want to Make an HTTP Request</h2>

<p class="todo">Add a section about <code>curl</code>.</p>

<h2 id="awk---i-want-to-filter-format-or-translate-tables">awk - I Want to Filter, Format, or Translate Tables</h2>

<p>“Pattern scanning and processing language.”</p>

<p><code>awk</code> is a programming language, but we’ll cover just the basics of how I most often use it.</p>

<p>The “program” is supplied as a string argument <code>'{ ... }'</code>. The commands in this block will be executed on every line of the input stream.</p>

<p>You can print the value from a specific column by using one of the numerical index variables:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"1 2 3 4 5"</span> | <span class="nb">awk</span> <span class="s1">'{ print $1 }'</span>  <span class="c"># prints 1</span>
<span class="nb">echo</span> <span class="s2">"1 2 3 4 5"</span> | <span class="nb">awk</span> <span class="s1">'{ print $4 }'</span>  <span class="c"># prints 4</span>
<span class="nb">echo</span> <span class="s2">"1 2 3 4 5"</span> | <span class="nb">awk</span> <span class="s1">'{ print $0 }'</span>  <span class="c"># prints 1 2 3 4</span>
</code></pre></div></div>

<p>The default field separator is ‘ ‘ (space), but you can specify a different delimiter with <code>-F</code>.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"1,2,3,4,5"</span> | <span class="nb">awk</span> <span class="nt">-F</span>, <span class="s1">'{ print $3 }'</span>  <span class="c"># prints 3</span>
</code></pre></div></div>

<p>The <code>printf</code> function is useful for formatting values:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"1,2,3,4,5"</span> | <span class="nb">awk</span> <span class="nt">-F</span>, <span class="s1">'{ printf "The number is %i\n", $2 }'</span>  <span class="c"># "The number is 2"</span>
</code></pre></div></div>

<p>Specify a pattern with <code>/PATTERN/</code> and it will apply the associated block on every line that matches the pattern.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># prints "Apples=$12.00"</span>
<span class="nb">echo</span> <span class="s2">"Apple 10 1.2</span><span class="se">\n</span><span class="s2">Orange 13 1.9"</span> | <span class="nb">awk</span> <span class="s1">'/Apple/ { printf "%s=$%.2f\n", $1, $2 * $3 }'</span>
</code></pre></div></div>

<h2 id="jq---i-want-to-filter-format-or-translate-json">jq - I Want to Filter, Format, or Translate JSON</h2>

<p><code>JSON</code> doesn’t really fit into this ‘lines of text’ paradigm. However, you may want to read JSON into lines of records or write tabular data out to JSON. We’ll mostly just cover basic operations and converting data to/from <code>JSON</code>.</p>

<h3 id="basics">Basics</h3>

<p>You pretty-format <code>JSON</code> data:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'{"a": 1, "b": [2, 3]}'</span> | jq
<span class="c"># or</span>
<span class="nb">echo</span> <span class="s1">'{"a": 1, "b": [2, 3]}'</span> | jq <span class="nb">.</span>
</code></pre></div></div>

<p>The <code>.</code> in the second example refers to the identity, or root of the object, which is the default argument if nothing is supplied.</p>

<p>You can use <code>.KEY</code> or <code>.[KEY]</code> to get the value of a specific key, or <code>.[N]</code> to get the value of an array element. And you can string them together to describe a path to the specific value(s) you want.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'{"a": 1, "b": [2, 3]}'</span> | jq <span class="s1">'.a'</span>  <span class="c"># prints "1"</span>
<span class="nb">echo</span> <span class="s1">'{"a": 1, "b": [2, 3]}'</span> | jq <span class="s1">'.b'</span>  <span class="c"># prints "[2, 3]"</span>
<span class="nb">echo</span> <span class="s1">'{"a": 1, "b": [2, 3]}'</span> | jq <span class="s1">'.b[1]'</span>  <span class="c"># prints "3"</span>
<span class="nb">echo</span> <span class="s1">'{"a": 1, "b": [2, 3]}'</span> | jq <span class="s1">'.a .b[1]'</span>  <span class="c"># prints "1 3"</span>
<span class="nb">echo</span> <span class="s1">'{"key": [{"id": 1}, {"id": 2}]}'</span> | jq <span class="s1">'.key[] | .id + 100'</span>  <span class="c"># prints "101 102"</span>
</code></pre></div></div>

<h3 id="you-can-turn-a-table-of-data-into-an-array-of-json-data">You can turn a table of data into an array of JSON data</h3>

<p>(<a href="./jq-table.data">jq-table.data file</a>)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>col1 col2 col3
row1-1 row1-2 row1-3
row2-1 row2-2 row2-3
row3-1 row3-2 row3-3
</code></pre></div></div>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> ./jq-table.data | jq <span class="nt">-Rs</span> <span class="s1">'rtrim | split("\n") | map(split(" "))'</span>
<span class="c"># or without the table header row</span>
<span class="nb">cat</span> ./jq-table.data | <span class="nb">tail</span> <span class="nt">-n</span>+2 | jq <span class="nt">-Rs</span> <span class="s1">'rtrim | split("\n") | map(split(" "))'</span>
</code></pre></div></div>

<ul>
  <li><code>-R</code> allows you to pass raw data to <code>jq</code> without having to wrap every line in quotes.</li>
  <li><code>-s</code> tells <code>jq</code> to read the entire thing at once, instead of expecting a stream of data.</li>
  <li><code>rtrim</code> trims extra text from the end of the lines, prevents an empty array at the end.</li>
  <li><code>split("\n")</code> splits by newlines, making one element for each “row”.</li>
  <li><code>map(split(" "))</code> - splits each “row” string into it’s individual elements.</li>
</ul>

<h3 id="turn-a-table-of-data-into-a-list-of-json-objects">Turn a table of data into a list of JSON objects:</h3>

<p>If you want to turn the rows into objects, you need to <code>map</code> the results to an object constructor that maps the keys to the indexes of the corresponding columns.</p>

<p><code>map({col1: .[0], col2: .[1], col3: .[1]})</code></p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> ./jq-table.data <span class="se">\</span>
    | jq <span class="nt">-Rs</span> <span class="s1">'rtrim | split("\n") | map(split(" ")) | map({col1: .[0], col2: .[1], col3: .[2]})'</span>
<span class="c"># or without the table header row</span>
<span class="nb">cat</span> ./jq-table.data | <span class="nb">tail</span> <span class="nt">-n</span>+2 <span class="se">\</span>
    | jq <span class="nt">-Rs</span> <span class="s1">'rtrim | split("\n") | map(split(" ")) | map({col1: .[0], col2: .[1], col3: .[2]})'</span>
</code></pre></div></div>

<h3 id="you-can-turn-a-json-array-into-a-table-of-data">You can turn a JSON array into a table of data:</h3>

<p>(<a href="./jq-table.json">jq-table.json file</a>)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
    [ "row1-1", "row1-2", "row1-3" ],
    [ "row2-1", "row2-2", "row2-3" ],
    [ "row3-1", "row3-2", "row3-3" ]
]
</code></pre></div></div>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> ./jq-table.json | jq <span class="nt">-r</span> <span class="s1">'["col1", "col2", "col3"], .[] | @tsv'</span>
</code></pre></div></div>

<ul>
  <li><code>-r</code> writes ‘raw’ output, without extra quotes.</li>
  <li><code>["col1", "col2", "col3"],</code> prepends a ‘title row’ to the table.</li>
  <li><code>@tsv</code> is a filter that prints the <code>JSON</code> data as tab-separated-values.</li>
</ul>

<h3 id="turn-list-of-json-objects-into-lines-of-records">Turn list of JSON objects into lines of records:</h3>

<p>(<a href="./jq-object.json">jq-object.json file</a>)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  { "col1": "row1-1", "col2": "row1-2", "col3": "row1-3" },
  { "col1": "row2-1", "col2": "row2-2", "col3": "row2-3" },
  { "col1": "row3-1", "col2": "row3-2", "col3": "row3-3" }
]
</code></pre></div></div>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> ./jq-object.json | jq <span class="nt">-r</span> <span class="s1">'.[] | [ .col1, .col2, .col3 ] | @tsv'</span>
</code></pre></div></div>

<hr />

<p><a href="./05_one-liners">NEXT »</a></p>

    </main>
    <footer>
      <a href="/jekyll-test/"> davelab</a>
      <section>
        <a href="/jekyll-test/test">(Secret test page)</a>
        <a href="/jekyll-test/about">ABOUT</a>
        <a href="https://github.com/dczmer/davelab.git" target="_blank"> GITHUB</a>
      </section>
    </footer>
  </body>
</html>
